(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[906],{84906:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return S}});var r=n(85893),a=n(51163),o=n(47568),i=n(70655),u=n(67294),s=n(88767),l=n(84714),c=n(18016),f=function(t,e){return(0,o.Z)((function(){var n;return(0,i.__generator)(this,(function(r){return n={},[2,l.ZP.post((0,c.fM)("/set-rating"),(n.movieId=t,n.value=e,n))]}))}))()},p=function(t){return(0,o.Z)((function(){return(0,i.__generator)(this,(function(e){return[2,l.ZP.get((0,c.fM)("/".concat(t)))]}))}))()},v=n(88116),d=n(16938),h=n(55794),g=n.n(h),y=n(82026),_=n(64396),m=n.n(_),S=function(t){var e=t.id,n=t.slug,l=(0,a.a)().user,c=function(t){var e=(0,u.useState)(0),n=e[0],r=e[1],a=(0,u.useState)(!1),l=a[0],c=a[1],h=(0,s.useQuery)(["your movie rating",t],(function(){return p(t)}),{onSuccess:function(t){var e=t.data;r(e)},onError:function(t){(0,v._)(t,"Get rating")},enabled:!!t}).refetch,g=(0,s.useMutation)("set rating movie",(function(e){var n=e.value;return f(t,n)}),{onError:function(t){(0,v._)(t,"Rate movie")},onSuccess:function(){d.Rt.success("Rate movie","You have successfully rated!"),c(!0),h(),setTimeout((function(){c(!1)}),2400)}}).mutateAsync,y=function(){var t=(0,o.Z)((function(t){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return r(t),[4,g(((e={}).value=t,e))];case 1:return n.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}();return{isSent:l,rating:n,handleClick:y}}(e),h=c.handleClick,_=c.isSent,S=c.rating;return(0,r.jsxs)("div",{className:g().wrapper,children:[(0,r.jsx)("h3",{children:"How do you like the movie?"}),(0,r.jsx)("p",{children:"Ratings improve recommendations"}),l?(0,r.jsx)(r.Fragment,{children:_?(0,r.jsx)("div",{className:g().thanks,children:"Thanks for rating!"}):(0,r.jsx)(m(),{name:"star-rating",value:S,onStarClick:h,emptyStarColor:"#4f4f4f"})}):(0,r.jsx)(y.Z,{slug:n})]})}},82026:function(t,e,n){"use strict";var r=n(85893),a=n(29550),o=n.n(a),i=n(41664),u=n.n(i),s=n(89583);e.Z=function(t){var e=t.slug;return(0,r.jsx)(u(),{href:"/auth?redirect=".concat((0,s.Xl)(e)),children:(0,r.jsx)("a",{className:o().btn,children:"Sign In"})})}},55794:function(t){t.exports={wrapper:"RateMovie_wrapper__f3KJF",thanks:"RateMovie_thanks__Z_JJp",scaleIn:"RateMovie_scaleIn__VA1v8"}},29550:function(t){t.exports={placeholder:"AuthPlaceholder_placeholder__YVzcU",btn:"AuthPlaceholder_btn__989TG"}},64396:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(67294),o=s(a),i=s(n(45697)),u=s(n(42293));function s(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={value:t.value},n}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillReceiveProps",value:function(t){var e=t.value;null!=e&&e!==this.state.value&&this.setState({value:e})}},{key:"onChange",value:function(t){var e=this.props,n=e.editing,r=e.value;n&&null==r&&this.setState({value:t})}},{key:"onStarClick",value:function(t,e,n,r){r.stopPropagation();var a=this.props,o=a.onStarClick;a.editing&&o&&o(t,e,n,r)}},{key:"onStarHover",value:function(t,e,n,r){r.stopPropagation();var a=this.props,o=a.onStarHover;a.editing&&o&&o(t,e,n,r)}},{key:"onStarHoverOut",value:function(t,e,n,r){r.stopPropagation();var a=this.props,o=a.onStarHoverOut;a.editing&&o&&o(t,e,n,r)}},{key:"renderStars",value:function(){for(var t=this,e=this.props,n=e.name,r=e.starCount,a=e.starColor,i=e.emptyStarColor,u=e.editing,s=this.state.value,l=function(t,e){return{float:"right",cursor:u?"pointer":"default",color:e>=t?a:i}},c={display:"none",position:"absolute",marginLeft:-9999},f=[],p=function(e){var r=n+"_"+e,a=o.default.createElement("input",{key:"input_"+r,style:c,className:"dv-star-rating-input",type:"radio",name:n,id:r,value:e,checked:s===e,onChange:t.onChange.bind(t,e,n)}),i=o.default.createElement("label",{key:"label_"+r,style:l(e,s),className:"dv-star-rating-star "+(s>=e?"dv-star-rating-full-star":"dv-star-rating-empty-star"),htmlFor:r,onClick:function(r){return t.onStarClick(e,s,n,r)},onMouseOver:function(r){return t.onStarHover(e,s,n,r)},onMouseLeave:function(r){return t.onStarHoverOut(e,s,n,r)}},t.renderIcon(e,s,n,r));f.push(a),f.push(i)},v=r;v>0;v--)p(v);return f.length?f:null}},{key:"renderIcon",value:function(t,e,n,r){var a=this.props,i=a.renderStarIcon,u=a.renderStarIconHalf;return"function"===typeof u&&Math.ceil(e)===t&&e%1!==0?u(t,e,n,r):"function"===typeof i?i(t,e,n,r):o.default.createElement("i",{key:"icon_"+r,style:{fontStyle:"normal"}},"\u2605")}},{key:"render",value:function(){var t=this.props,e=t.editing,n=t.className,r=(0,u.default)("dv-star-rating",{"dv-star-rating-non-editable":!e},n);return o.default.createElement("div",{style:{display:"inline-block",position:"relative"},className:r},this.renderStars())}}]),e}(a.Component);l.propTypes={name:i.default.string.isRequired,value:i.default.number,editing:i.default.bool,starCount:i.default.number,starColor:i.default.string,onStarClick:i.default.func,onStarHover:i.default.func,onStarHoverOut:i.default.func,renderStarIcon:i.default.func,renderStarIconHalf:i.default.func},l.defaultProps={starCount:5,editing:!0,starColor:"#ffb400",emptyStarColor:"#333"},e.default=l,t.exports=e.default},42293:function(t,e){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var o=typeof n;if("string"===o||"number"===o)t.push(n);else if(Array.isArray(n)){if(n.length){var i=a.apply(null,n);i&&t.push(i)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){t.push(n.toString());continue}for(var u in n)r.call(n,u)&&n[u]&&t.push(u)}}}return t.join(" ")}t.exports?(a.default=a,t.exports=a):void 0===(n=function(){return a}.apply(e,[]))||(t.exports=n)}()}}]);